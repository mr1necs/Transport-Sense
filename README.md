# Transport-Sense

## Описание проекта
Transport-Sense — это Python-приложение для детекции автомобилей, мотоциклов и грузовиков на видео с помощью предобученной модели YOLO (Ultralytics, COCO). Программа обрабатывает входное видео, выделяет заданную многоугольную область интереса (ROI) на каждом кадре и определяет наличие целевых объектов (car, motorcycle, truck) внутри этой области.

## Структура проекта
- **main.py** — Точка входа. Управляет обработкой видео, детекцией и выводом результата.
- **modules/yolo_model.py** — Класс для загрузки и инференса модели YOLO, выбора устройства (CPU/GPU/MPS).
- **modules/video_stream.py** — Класс для работы с видеопотоком: открытие, чтение кадров, освобождение ресурсов.
- **modules/utils.py** — Парсинг аргументов командной строки и вспомогательные функции.
- **cvtest.avi** — Пример входного видео.
- **requirements.txt** — Список зависимостей для установки.

## Возможности
- Детекция автомобилей, мотоциклов и грузовиков (COCO class IDs: 2, 3, 7) на видео с помощью моделей YOLO.
- Анализ только в заданной многоугольной области кадра (ROI).
- Логирование наличия целевых объектов в ROI для каждого кадра.
- Опциональный вывод видео с выделенной областью и рамками в реальном времени на экран.
- Кроссплатформенность: работает на Linux, macOS и Windows.

## Установка
1. Клонируйте репозиторий или скачайте исходный код:
   ```bash
   git clone https://github.com/mr1necs/Transport-Sense
   cd Transport-Sense
   ```
2. Установите необходимые зависимости:
   ```bash
   pip install -r requirements.txt
   ```

## Использование
Запустите программу из командной строки:
```bash
python main.py --input cvtest.avi --model yolo11n.pt --device cpu --show
```

### Аргументы командной строки
- `-i`, `--input`   : Путь к входному видеофайлу (по умолчанию: камера).
- `-m`, `--model`   : Путь к файлу модели YOLO или имя модели (по умолчанию: `yolo11n.pt`).
- `-d`, `--device`  : Устройство для инференса: `cpu`, `cuda` или `mps` (по умолчанию: `cpu`).
- `-s`, `--show`    : Показывать видео с выделенной областью и результатами в окне во время обработки (по умолчанию: выкл.).

### Пример
```bash
python main.py --input cvtest.avi --model yolo11n.pt --device mps --show
```

## Результат
- Для каждого кадра анализируется наличие автомобилей, мотоциклов и грузовиков в заданной области (ROI).
- В консоль выводится информация о наличии целевых объектов в ROI.
- При включённом флаге `--show` отображается видео с выделенной областью интереса.

## Примечания
- Используется модель YOLO, обученная на COCO (по умолчанию `yolo11n.pt`). Можно указать другую совместимую модель.
- Программа использует только open-source библиотеки и не требует проприетарного ПО.

## Лицензия
Проект распространяется под лицензией MIT.